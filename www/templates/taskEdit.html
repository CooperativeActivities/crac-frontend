<ion-view hide-nav-bar="false">
  <ion-nav-title>{{formTitle}}</ion-nav-title>
  <ion-nav-buttons side="right">
    <button class="button icon ion-checkmark"  ng-click="save_changes()"></button>
  </ion-nav-buttons>
  <ion-content padding="true" class="manual-ios-statusbar-padding has-footer">
    <div>
      <form name="taskForm" onsubmit="event.preventDefault" novalidate>
		<div class="form-group" ng-if="isNewTask">
			<div class="half-container">
				<ion-radio ng-model="task.taskType" name="type" value="ORGANISATIONAL">Übersicht</ion-radio>
			</div><div class="half-container">
				<ion-radio ng-model="task.taskType" name="type" value="WORKABLE">Aufgabe</ion-radio>
			</div>
		</div>
		<div class="item item-divider-top">Basisinformationen</div>
        <div class="form-block form-group" ng-class="{'has-error has-feedback': taskForm.name.$dirty && taskForm.name.$invalid, 'has-success has-feedback':taskForm.name.$dirty && taskForm.name.$valid}">
          <label class="item item-input item-stacked-label">
            <span class="input-label bold">Titel*:</span>
            <input type="text" ng-model="task.name" name="name" style="background-color:white;" placeholder="Name..."
                   aria-describedby="inputError2Status" class="form-control" required>
            <span class="glyphicon glyphicon-remove form-control-feedback" aria-hidden="true" ng-if="taskForm.name.$dirty && taskForm.name.$invalid"></span>
            <span class="glyphicon glyphicon-ok form-control-feedback" aria-hidden="true" ng-if="taskForm.name.$dirty && taskForm.name.$valid"></span>
           <span id="inputError2Status" ng-show="taskForm.name.$dirty && taskForm.name.$invalid" class="help-block">
                   Bitte geben Sie einen Tasktitel ein.
               </span>
          </label>
          <label class="item item-input item-stacked-label">
            <span class="input-label bold">Beschreibung:</span>
            <textarea ng-model="task.description" placeholder="Beschreibung..." ></textarea>
          </label>
          <label class="item item-input item-stacked-label" ng-if="task.taskType == 'WORKABLE'">
            <span class="input-label bold">Zahl der Freiwilligen:</span>
            <input type="number" min="0" ng-model="task.minAmountOfVolunteers" placeholder="Anzahl...">
          </label>
        </div>
        <div class="form-block" >
          <div class="item item-divider-top">Zeit und Ort</div>

          <div class="time-select-box item item-input item-input-table">
            <ion-list>
              <ion-radio ng-model="timeChoice" name="choice" value="slot" class="no-border-radius" >Zeitraum</ion-radio>
              <ion-radio ng-model="timeChoice" name="choice" value="point" class="no-border-radius" >Zeitpunkt</ion-radio>

            </ion-list>

            <div ng-show="timeChoice == 'slot'" class="time-slot">

              <label class="item item-input c-timebox ">
              <span class="input-label bold">Beginn:</span>
              <input type="datetime-local" ng-model="task.startTime"  ng-class="{'has-error' : !task.startTime}" >
            </label>
              <label class="item item-input c-timebox">
                <span class="input-label bold">Ende:</span>
                <input type="datetime-local" ng-model="task.endTime" ng-class="{'has-error' : !task.endTime}" >
              </label>
            </div>

            <div ng-show="timeChoice == 'point'" class="time-point ">
              <label class="item item-input c-timebox ">
                <span class="input-label bold"></span>

              </label>
              <label class="item item-input c-timebox ">
                <input type="datetime-local" ng-model="task.endTime" ng-class="{'has-error' : !task.endTime}" >
              </label>
            </div>
          </div>

          <div class="item item-input item-stacked-label">
            <span class="input-label bold">Adresse:</span>
            <input type="text" ng-model="task.address" placeholder="Adresse" >
            <a type="button" ng-click="openMap()" class="button button-icon icon ion-android-locate" style="position: absolute;top: 10px;right: 12px;z-index:100;"></a>
          </div>
          <label class="item item-input item-stacked-label">
            <span class="input-label bold">Raum/Gebäude:</span>
            <input type="text" ng-model="task.location" placeholder="Raum/Gebäude" >
          </label>
        </div>
      </form>
    </div>

      <div ng-if="isNewTask && task.taskType == 'WORKABLE'">

          <button type="button" ng-click="save_changes()" class="button button-full button-positive ion-plus no-border-radius"> Details hinzufügen</button>

      </div>

      <div ng-if="!isNewTask && task.taskType == 'WORKABLE'">
          <c-accordion title="' Details '">
          <ion-list >
              <ion-item class="item-icon-right" ng-click="advancedEdit('competences')">
                  Kompetenzen ({{task.taskCompetences.length}})
                  <i class="icon ion-chevron-right"></i>
              </ion-item>
              <ion-item class="item-icon-right" ng-click="advancedEdit('materials')">
                  Materialen ({{task.materials.length}})
                  <i class="icon ion-chevron-right"></i>
              </ion-item>
              <ion-item class="item-icon-right" ng-click="advancedEdit('shifts')">
                  Schichten ({{task.childTasks.length}})
                  <i class="icon ion-chevron-right"></i>
              </ion-item>
          </ion-list>
              </c-accordion>
      </div>



  </ion-content>
  <ion-footer-bar>
    <div class="button-bar">
      <button ng-click="delete()" ng-if="showDelete"  class="button button-small button-full no-border-radius button-assertive ion-trash-a"> Löschen </button>
      <button ng-click="save_and_unpublish()"   ng-if="showUnpublish" class="button button-small button-full no-border-radius button-positive ion-eye-disabled"> Zurückziehen </button>
      <button ng-click="save_and_publish()"   ng-if="showPublish" class="button button-small button-full no-border-radius button-balanced ion-eye"> Veröffentlichen </button>
    </div>
  </ion-footer-bar>
</ion-view>
