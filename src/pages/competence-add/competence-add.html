<ion-header>
  <!-- navbar intentionally left out -->
  <ion-toolbar>
    <ion-title>Kompetenz Hinzufügen</ion-title>
  </ion-toolbar>
  <ion-toolbar>
    <div class="toolbar-buttons">
      <button ion-button (click)="cancel()" color="light" block>
        Abbrechen
      </button>
      <button ion-button (click)="add()" color="secondary" block
              [disabled]="newComp.id === -1">
        Speichern
      </button>
    </div>
  </ion-toolbar>

</ion-header>
<ion-content>
  <ion-card *ngIf="loading">
    <ion-card-content>
      Kompetenzen werden geladen...
    </ion-card-content>
  </ion-card>
  <ion-card *ngIf="!loading && allCompetenceAreas?.length == 0">
    <ion-card-content>
      Kompetenzbereiche konnten nicht geladen werden.
    </ion-card-content>
  </ion-card>
  <ion-card *ngIf="!loading && allCompetenceAreas.length > -1">
    <ion-card-content>
      <ion-list>
        <ion-item>
          <ion-label stacked>Kompetenzbereich</ion-label>
          <ion-label *ngIf="competenceArea" (click)="resetCompetenceArea()">
            {{competenceArea.name}}
          </ion-label>
        </ion-item>
        <ion-item *ngIf="newComp.id != -1">
          <ion-label stacked>Kompetenz</ion-label>
          <ion-label (click)="resetCompetence()">
            {{newComp.name}}
          </ion-label>
        </ion-item>
        <ion-searchbar *ngIf="!competenceArea" (ionInput)="filterAreas($event)"></ion-searchbar>
        <ion-list *ngIf="!competenceArea">
          <ng-container *ngFor="let area of competenceAreaList">
            <button ion-item *ngIf="area.mappedCompetences.length != 0" (click)="getCompetencesForArea(area)">
              {{area.name}}
            </button>
          </ng-container>
          <ion-item *ngIf="competenceAreaList.length == 0">
            Keine Kompetenzbereiche gefunden.
          </ion-item>
        </ion-list>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="competenceArea && newComp.id == -1">
    <ion-card-header icon-right ion-item (click)="resetCompetenceArea()">
      <ion-icon name="arrow-dropup" item-right></ion-icon>
      Bereich: {{ competenceArea.name }}
    </ion-card-header>
    <ion-card-content>
      <ion-list>
        <button ion-item *ngFor="let item of competences" (click)="setCompetenceSelect(item)">
          {{item.name}}
        </button>
      </ion-list>
    </ion-card-content>
  </ion-card>

  <ion-card *ngIf="newComp.id != -1">
    <ion-card-content>
      <ion-list>
        <ion-item>
          {{newComp.description}}
        </ion-item>
        <ion-item>
          <ion-label stacked>Gefällt mir<span float-right>{{newComp.likeValue}}</span></ion-label>
          <ion-range min="0" max="100" [ngModelOptions]="{standalone: true}"
                     [(ngModel)]="newComp.likeValue">
          </ion-range>
        </ion-item>
        <ion-item>
          <ion-label stacked>Kann ich<span float-right>{{newComp.proficiencyValue}}</span></ion-label>
          <ion-range min="0" max="100" [ngModelOptions]="{standalone: true}"
                     [(ngModel)]="newComp.proficiencyValue">
          </ion-range>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>
</ion-content>
